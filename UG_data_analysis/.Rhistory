ylab("Predicted probability of acceptance")
m_att <- glm(attempter$AcceptOffer ~ fairness, data = attempter, family = "binomial")
m_HC <- glm(control$AcceptOffer ~ fairness, data = control, family = "binomial")
m_ideator <- glm(ideator$AcceptOffer ~ fairness, data = ideator, family = "binomial")
m_dep <- glm(depression$AcceptOffer ~ fairness, data = depression, family = "binomial")
m_attHL <- glm(attHL$AcceptOffer ~ fairness, data = attHL, family = "binomial")
m_attLL <- glm(attLL$AcceptOffer ~ fairness, data = attLL, family = "binomial")
predict_att <- as.data.frame(predict(m_att, newdata = attempter, type = "response", se = TRUE))
predict_HC <- as.data.frame(predict(m_HC, newdata = control, type = "response", se = TRUE))
predict_ideator <- as.data.frame(predict(m_ideator, newdata = ideator, type = "response", se = TRUE))
predict_dep <- as.data.frame(predict(m_dep, newdata = depression, type = "response", se = TRUE))
predict_attHL <- as.data.frame(predict(m_attHL, newdata = attHL, type = "response", se = TRUE))
predict_attLL <- as.data.frame(predict(m_attLL, newdata = attLL, type = "response", se = TRUE))
new_att <- cbind(attempter, predict_att)
new_HC <- cbind(control, predict_HC)
new_ideator <- cbind(ideator, predict_ideator)
new_dep <- cbind(depression, predict_dep)
new_attHL <- cbind(attHL, predict_attHL)
new_attLL <- cbind(attLL, predict_attLL)
new_data4 <- rbind.fill(new_att, new_HC, new_ideator, new_dep)
new_data5 <- rbind(new_HC, new_ideator, new_dep, new_attHL, new_attLL)
ggplot(new_data4, aes(x = factor(fairness), y = fit, fill = factor(group4))) + geom_point() + ylim(0, 1) + ggtitle("Predicted acceptance of gamble") +
facet_wrap(~group4) +
ylab("Predicted probability of acceptance")
ggplot(new_data5, aes(x = factor(fairness), y = fit, fill = factor(group5))) + geom_point() + ylim(0, 1) + ggtitle("Predicted acceptance of gamble") +
facet_wrap(~group5) +
ylab("Predicted probability of acceptance")
summary(m_long_level12_inter34)
print(m_long_level12_inter34$bobyqa.)
print(m_long_level12_inter34)
summary(modellist1)
print(modellist1)
for (i in modellist1){
print(i)
}
print(m_long_level12_inter2)
print(m_long_level12_inter4_1)
print(m_long_level12_inter4)
print(m_long_level12_inter6)
print(m_long_level12_inter7)
print(m_long_level12_inter9)
print(m_long_level12_inter11)
print(m_long_level12_inter12)
print(m_long_level12_inter14)
print(m_long_level12_inter15)
print(m_long_level12_inter16)
message(m_long_level12_inter16)
message(m_long_level12_inter16)
message(m_long_level12_inter15)
warnings(m_long_level12_inter15)
summary(warnings(m_long_level12_inter15))
summary(warnings(m_long_level12_inter16))
print(m_long_level12_inter15)
print(m_long_level12_inter16)
print(m_long_level12_inter17)
print(m_long_level12_inter19)
print(m_long_level12_inter20)
print(m_long_level12_inter22)
print(m_long_level12_inter23)
print(m_long_level12_inter31)
print(m_long_level12_inter31$bobyqa.)
print(m_long_level12_inter32)
print(m_long_level12_inter33)
print(m_long_level12_inter34$bobyqa.)
print(m_long_level12_inter35$bobyqa.)
print(m_long_level12_inter36$bobyqa.)
print(m_long_level12_inter36)
print(m_long_level12_inter37)
print(m_long_level12_inter38)
print(m_long_level12_inter39)
print(m_long_level12_inter322)
print(m_long_level12_inter333)
print(m_long_level12_inter344)
print(m_long_level12_inter344$optimx.nlminb)
print(m_long_level12_inter355$optimx.nlminb)
print(m_long_level12_inter366$optimx.nlminb)
print(m_long_level12_inter377)
print(m_long_level12_inter388)
print(m_long_level12_inter399)
modellist1 <- model.sel(m_long_level12_2, m_long_level12_inter2, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter6, m_long_level12_inter7, m_long_level12_inter9, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter31$bobyqa., m_long_level12_inter32, m_long_level12_inter33, m_long_level12_inter34$bobyqa., m_long_level12_inter35$bobyqa., m_long_level12_inter36, m_long_level12_inter37, m_long_level12_inter38, m_long_level12_inter39, m_long_level12_inter322, m_long_level12_inter333, m_long_level12_inter344$optimx.nlminb, m_long_level12_inter355$optimx.nlminb, m_long_level12_inter366$optimx.nlminb, m_long_level12_inter377, m_long_level12_inter388, m_long_level12_inter399)
print(get.models(modellist1, subset = delta < 10))
print(modellist1)
print(m_long_level12_inter31)
print(m_long_level12_inter31$bobyqa.)
print(modellist1$bobyqa.)
print(modellist1)
print(get.models(modellist1, subset = delta < 10))
modellist1 <- model.sel(m_long_level12_2, m_long_level12_inter2, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter6, m_long_level12_inter7, m_long_level12_inter9, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter31$bobyqa., m_long_level12_inter32, m_long_level12_inter33, m_long_level12_inter34$bobyqa., m_long_level12_inter35$bobyqa., m_long_level12_inter36, m_long_level12_inter37, m_long_level12_inter38, m_long_level12_inter39, m_long_level12_inter322, m_long_level12_inter333, m_long_level12_inter344$optimx.nlminb, m_long_level12_inter355$optimx.nlminb, m_long_level12_inter366$optimx.nlminb, m_long_level12_inter377, m_long_level12_inter388, m_long_level12_inter399, m_long_level12_inter16)
print(modellist1)
anova(m_long_level12_inter34, m_long_level12_inter35)
anova(m_long_level12_inter34, m_long_level12_inter35)
anova(m_long_level12_inter34$bobyqa., m_long_level12_inter35$bobyqa.)
print(modellist1)
print(modellist1)
summary(m_long_level12_3)
modellist_noInteraction <- model.sel(m_long_level12_interceptOnly, m_long_level12_1, m_long_level12_2, m_long_level12_3, m_long_level12_2_T, m_long_level12_2_M, m_long_level12_2_M1, m_long_level12_2_H, m_long_level12_2_MS, m_long_level12_2_S, m_long_level12_2_I, m_long_level12_2_G)
print(modellist_noInteraction)
print(m_level12_11_all)
print(m_level12_12_all)
print(m_level12_12_all$bobyqa.)
print(m_level12_12_all$Nelder_Mead.)
print(m_level12_12_all$optimx.nlminb)
print(m_level12_12_all$`optimx.L-BFGS-B`)
print(m_level12_12_all$nloptwrap.NLOPT_LN_NELDERMEAD)
print(m_level12_1)
anova(m_level12_1, m_level12_12_all$bobyqa.)
print(m_level12_2)
print(m_level12_22_all)
print(m_level12_23_all)
print(m_level12_23_all$bobyqa.)
print(m_level12_23_all$optimx.nlminb)
anova(m_level12_2, m_level12_23_all$bobyqa.)
knitr::opts_chunk$set(echo = TRUE)
library(lme4)
library(ggplot2)
library(GGally)
library(plyr)
library(Matrix)
library(nlme)
library(readxl)
library(reshape2)
library(VIF)
library(numDeriv)
library(MuMIn)
library(HLMdiag)
library(DHARMa)
library(bitops)
library(nloptr)
library(optimx)
library(dfoptim)
library(emmeans)
library(afex)
library(usdm)
library(car)
summary(m_long_level12_3_all)
print(m_long_level12_3_all)
print(m_long_level12_3)
print(m_long_level12_2_T)
print(m_long_level12_2)
print(m_long_level12_2_M)
print(m_long_level12_2_M1)
print(m_long_level12_2_H)
print(m_long_level12_2_MS)
print(m_long_level12_2_S)
print(m_long_level12_2_I)
print(m_long_level12_2_G)
print(m_long_level12_1)
print(m_long_level12_interceptOnly)
m_long_level12_interceptOnly_T <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + Trial_Number + (1|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE), na.action = "na.fail")
anova(m_long_level12_interceptOnly, m_long_level12_interceptOnly_T)
print(m_long_level12_interceptOnly_T)
anova(m_long_level12_interceptOnly, m_long_level12_interceptOnly_T)
m_long_level12_1_T <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + Trial_Number + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
anova(m_long_level12_1, m_long_level12_1_T)
print(m_long_level12_1_T)
m_long_level12_3_T <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + scale(Trial_Number) + Trial_Number + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
m_long_level12_3 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + scale(Trial_Number) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
m_long_level12_3 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + scale(Trial_Number) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
m_long_level12_3_T <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + scale(Trial_Number) + Trial_Number + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
anova(m_long_level12_3, m_long_level12_3_T)
modellist_noInteraction <- model.sel(m_long_level12_interceptOnly, m_long_level12_1, m_long_level12_2, m_long_level12_3, m_long_level12_2_T, m_long_level12_2_M, m_long_level12_2_M1, m_long_level12_2_H, m_long_level12_2_MS, m_long_level12_2_S, m_long_level12_2_I, m_long_level12_2_G, m_long_level12_interceptOnly_T, m_long_level12_1_T)
print(modellist_noInteraction)
print(modellist_noInteraction)
modellist_noInteraction <- model.sel(m_long_level12_interceptOnly, m_long_level12_1, m_long_level12_1_T, m_long_level12_2, m_long_level12_2_T, m_long_level12_3)
print(modellist_noInteraction)
print(m_d_long_level12_2)
print(get.models(m_d_long_level12_2, subset = delta < 2))
summary(m_d_long_level12_2_avg1)
modellist3 <- model.sel(m_long_level12_interceptOnly, m_long_level12_1, m_long_level12_2, m_long_level12_3, m_long_level12_2_T, m_long_level12_2_M, m_long_level12_2_M1, m_long_level12_2_H, m_long_level12_2_MS, m_long_level12_2_S, m_long_level12_2_I, m_long_level12_2_G, m_long_level12_interceptOnly_T, m_long_level12_1_T)
print(modellist3)
anova(m_long_level12_2_MS, m_long_level12_2_H)
print(m_long_level12_2_H)
summary(m_long_level12_2_H)
print(modellist_noInteraction)
anova(m_long_level12_inter2, m_long_level12_inter3)
m_long_level12_inter1_1 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 * RACETEXT+ scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
anova(m_long_level12_inter1, m_long_level12_inter1_2)
anova(m_long_level12_inter1, m_long_level12_inter1_1)
modellist4 <- model.sel(m_long_level12_2, m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4, m_long_level12_inter4_1, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter7)
print(modellist4)
anova(m_long_level12_2, m_long_level12_inter7)
print(modellist4)
anova(m_long_level12_2, m_long_level12_inter2)
print(modellist4)
try <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + RACETEXT+ scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
anova(try, m_long_level12_inter1)
modellist5 <- model.sel(m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter8, m_long_level12_inter9, m_long_level12_inter10, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter16, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23)
print(modellist5)
ggpairs(demoQuestion[, c("PROTECT2AGE", "HOUSEHOLD INCOME", "HRSD NO SUI", "DRS", "EDUCATION")])
cor.test(allData$MMSE, allData$EDUCATION)
ggpairs(demoQuestion[, c("PROTECT2AGE", "HOUSEHOLD INCOME", "HRSD NO SUI", "DRS", "EDUCATION", "MMSE")])
cor.test(allData$MMSE, allData$HouseholdIncome)
### age x HRSD
m_long_level12_inter23 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + scale(HouseholdIncome) + RACETEXT + scale(PROTECT2AGE) * scale(HRSD_NO_SUI) + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### age x HRSD
m_long_level12_inter29 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + scale(HouseholdIncome) + RACETEXT + scale(PROTECT2AGE) * scale(HRSD_NO_SUI) + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### age x education
m_long_level12_inter24 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + scale(HouseholdIncome) + RACETEXT + scale(PROTECT2AGE) * scale(EDUCATION) + scale(HRSD_NO_SUI) + GENDERTEXT + scale(MMSE) +  MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### HRSD x income
m_long_level12_inter25 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + RACETEXT + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) * scale(HouseholdIncome) + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### Education x income
m_long_level12_inter26 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + scale(HouseholdIncome) * scale(EDUCATION) + RACETEXT + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + GENDERTEXT + scale(MMSE) +  MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### gender x income
m_long_level12_inter27 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + RACETEXT + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + GENDERTEXT * scale(HouseholdIncome) + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### race x income
m_long_level12_inter28 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + scale(HouseholdIncome) * RACETEXT + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
m_long_level12_inter28 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + scale(HouseholdIncome) * RACETEXT + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### MMSE x education
m_long_level12_inter30 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group5 + scale(HouseholdIncome) + RACETEXT + scale(PROTECT2AGE) + scale(HRSD_NO_SUI) + GENDERTEXT + scale(MMSE) * scale(EDUCATION) + MARITALTEXT + (1|ID) + (0 + Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
print(m_long_level12_inter24)
print(m_long_level12_inter25)
print(m_long_level12_inter26)
print(m_long_level12_inter27)
print(m_long_level12_inter28)
print(m_long_level12_inter29)
print(m_long_level12_inter30)
modellist5 <- model.sel(m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter8, m_long_level12_inter9, m_long_level12_inter10, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter16, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter24, m_long_level12_inter25, m_long_level12_inter26, m_long_level12_inter27, m_long_level12_inter28, m_long_level12_inter29, m_long_level12_inter30)
print(modellist5)
anova(m_long_level12_inter1, m_long_level12_2)
modellist5 <- model.sel(m_long_level12_2, m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter8, m_long_level12_inter9, m_long_level12_inter10, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter16, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter24, m_long_level12_inter25, m_long_level12_inter26, m_long_level12_inter27, m_long_level12_inter28, m_long_level12_inter29, m_long_level12_inter30)
print(modellist5)
print(modellist1)
modells1 <- modellist5 + modellist1
modellist1 <- model.sel(m_long_level12_2, m_long_level12_inter2, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter6, m_long_level12_inter7, m_long_level12_inter9, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter31$bobyqa., m_long_level12_inter32, m_long_level12_inter33, m_long_level12_inter34$bobyqa., m_long_level12_inter35$bobyqa., m_long_level12_inter36, m_long_level12_inter37, m_long_level12_inter38, m_long_level12_inter39, m_long_level12_inter322, m_long_level12_inter333, m_long_level12_inter344$optimx.nlminb, m_long_level12_inter355$optimx.nlminb, m_long_level12_inter366$optimx.nlminb, m_long_level12_inter377, m_long_level12_inter388, m_long_level12_inter399, m_long_level12_inter16, m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter8, m_long_level12_inter9, m_long_level12_inter10, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter16, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter24, m_long_level12_inter25, m_long_level12_inter26, m_long_level12_inter27, m_long_level12_inter28, m_long_level12_inter29, m_long_level12_inter30)
print(modellist1)
### group4 x scale(EDUCATION) x scale(PROTECT2AGE) x fairness_score
m_long_level12_inter3111 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * Fairness_score * scale(EDUCATION) * scale(PROTECT2AGE) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### group4 x scale(EDUCATION) x scale(PROTECT2AGE)
m_long_level12_inter3222 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + RACETEXT + group4 * scale(EDUCATION) * scale(PROTECT2AGE) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### scale(EDUCATION) x scale(PROTECT2AGE) x fairness_score
#significantly better than the no interaction model
m_long_level12_inter3333 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 + Fairness_score * scale(EDUCATION) * scale(PROTECT2AGE) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
summary(m_long_level12_inter333)
### group4 x scale(PROTECT2AGE) x fairness_score
m_long_level12_inter3444 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * Fairness_score  * scale(PROTECT2AGE) + scale(EDUCATION) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), control = lmerControl(optimizer = "optimx.nlminb"), na.action = "na.fail")
knitr::opts_chunk$set(echo = TRUE)
library(lme4)
library(ggplot2)
library(GGally)
library(plyr)
library(Matrix)
library(nlme)
library(readxl)
library(reshape2)
library(VIF)
library(numDeriv)
library(MuMIn)
library(HLMdiag)
library(DHARMa)
library(bitops)
library(nloptr)
library(optimx)
library(dfoptim)
library(emmeans)
library(afex)
library(usdm)
library(car)
m_long_level12_inter3111 <- all_fit(m_long_level12_inter3111)
### group4 x scale(PROTECT2AGE) x fairness_score
m_long_level12_inter3444 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * Fairness_score  * scale(PROTECT2AGE) + scale(EDUCATION) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4) , optimizer = "optimx.nlminb"), na.action = "na.fail")
print(m_long_level12_inter31$bobyqa.)
summary(m_long_level12_inter31$bobyqa.)
print(m_long_level12_inter3444)
m_long_level12_inter3444 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * Fairness_score  * scale(PROTECT2AGE) + scale(EDUCATION) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4) , optimizer = "optimx.nlminb"), na.action = "na.fail")
### group4 x scale(PROTECT2AGE) x fairness_score
m_long_level12_inter3444 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * Fairness_score  * scale(PROTECT2AGE) + scale(EDUCATION) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### group4 x scale(EDUCATION) x fairness_score
m_long_level12_inter3555 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * Fairness_score * scale(EDUCATION) + scale(MMSE) + scale(PROTECT2AGE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4, "optimx.nlminb")), na.action = "na.fail")
### group4 x [scale(EDUCATION) + scale(PROTECT2AGE) + fairness_score]
#### optimizer = optimx.nlminb
m_long_level12_inter3666 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * (Fairness_score + scale(EDUCATION) + scale(PROTECT2AGE)) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4), optimizer = "optimx.nlminb"), na.action = "na.fail")
print(m_long_level12_inter3222)
print(m_long_level12_inter3333)
print(m_long_level12_inter3444)
m_long_level12_inter3666 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * (Fairness_score + scale(EDUCATION) + scale(PROTECT2AGE)) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### group4 x [scale(EDUCATION) + scale(PROTECT2AGE)]
m_long_level12_inter3777 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + RACETEXT + group4 * (scale(EDUCATION) + scale(PROTECT2AGE)) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### group4 x [scale(PROTECT2AGE) + fairness_score]
m_long_level12_inter3888 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * (Fairness_score + scale(PROTECT2AGE)) + scale(EDUCATION) + scale(MMSE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
### group4 x (scale(EDUCATION) + fairness_score)
m_long_level12_inter3999 <- glmer(framingData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + RACETEXT + group4 * (Fairness_score + scale(EDUCATION)) + scale(MMSE) + scale(PROTECT2AGE) + scale(HouseholdIncome) +  scale(HRSD_NO_SUI) + GENDERTEXT +  MARITALTEXT + (Trial_Number|ID), data = framingData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
modellist1 <- model.sel(m_long_level12_2, m_long_level12_inter2, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter6, m_long_level12_inter7, m_long_level12_inter9, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter31$bobyqa., m_long_level12_inter32, m_long_level12_inter33, m_long_level12_inter34$bobyqa., m_long_level12_inter35$bobyqa., m_long_level12_inter36, m_long_level12_inter37, m_long_level12_inter38, m_long_level12_inter39, m_long_level12_inter322, m_long_level12_inter333, m_long_level12_inter344$optimx.nlminb, m_long_level12_inter355$optimx.nlminb, m_long_level12_inter366$optimx.nlminb, m_long_level12_inter377, m_long_level12_inter388, m_long_level12_inter399, m_long_level12_inter16, m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter8, m_long_level12_inter9, m_long_level12_inter10, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter16, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter24, m_long_level12_inter25, m_long_level12_inter26, m_long_level12_inter27, m_long_level12_inter28, m_long_level12_inter29, m_long_level12_inter30, m_long_level12_inter3222, m_long_level12_inter3333, m_long_level12_inter3444, m_long_level12_inter3555, m_long_level12_inter3666, m_long_level12_inter3777, m_long_level12_inter3888, m_long_level12_inter3999)
print(m_long_level12_inter3999)
print(m_long_level12_inter3888)
print(m_long_level12_inter3777)
print(m_long_level12_inter3666)
print(m_long_level12_inter3555)
print(m_long_level12_inter3444)
print(m_long_level12_inter3333)
print(m_long_level12_inter2222)
print(m_long_level12_inter3222)
print(m_long_level12_inter3111)
modellist1 <- model.sel(m_long_level12_2, m_long_level12_inter2, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter6, m_long_level12_inter7, m_long_level12_inter9, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter31$bobyqa., m_long_level12_inter32, m_long_level12_inter33, m_long_level12_inter34$bobyqa., m_long_level12_inter35$bobyqa., m_long_level12_inter36, m_long_level12_inter37, m_long_level12_inter38, m_long_level12_inter39, m_long_level12_inter322, m_long_level12_inter333, m_long_level12_inter344$optimx.nlminb, m_long_level12_inter355$optimx.nlminb, m_long_level12_inter366$optimx.nlminb, m_long_level12_inter377, m_long_level12_inter388, m_long_level12_inter399, m_long_level12_inter16, m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter8, m_long_level12_inter9, m_long_level12_inter10, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter16, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter24, m_long_level12_inter25, m_long_level12_inter26, m_long_level12_inter27, m_long_level12_inter28, m_long_level12_inter29, m_long_level12_inter30, m_long_level12_inter3222, m_long_level12_inter3333, m_long_level12_inter3444, m_long_level12_inter3555, m_long_level12_inter3666, m_long_level12_inter3777, m_long_level12_inter3888, m_long_level12_inter3999)
print(modellist1)
m_long_level12_inter3555 <- all_fit(m_long_level12_inter3555)
knitr::opts_chunk$set(cache = TRUE)
library(lme4)
library(ggplot2)
library(GGally)
library(plyr)
library(Matrix)
library(nlme)
library(readxl)
library(reshape2)
library(VIF)
library(numDeriv)
library(MuMIn)
library(HLMdiag)
library(DHARMa)
library(bitops)
library(nloptr)
library(optimx)
library(dfoptim)
library(emmeans)
library(afex)
library(usdm)
library(car)
print(m_long_level12_inter3555)
print(m_long_level12_inter3444)
m_long_level12_inter3444 <- all_fit(m_long_level12_inter3444)
m_long_level12_inter3555 <- all_fit(m_long_level12_inter3555)
print(m_long_level12_inter3444)
print(m_long_level12_inter3444$bobyqa.)
print(m_long_level12_inter3444$Nelder_Mead.)
print(m_long_level12_inter3444$optimx.nlminb)
print(m_long_level12_inter3444$`optimx.L-BFGS-B`)
print(m_long_level12_inter3444$nloptwrap.NLOPT_LN_NELDERMEAD)
print(m_long_level12_inter3444$nloptwrap.NLOPT_LN_BOBYQA)
print(m_long_level12_inter3444$nmkbw.)
print(m_long_level12_inter3555)
print(m_long_level12_inter3666)
print(m_long_level12_inter3777)
print(m_long_level12_inter3888)
print(m_long_level12_inter3999)
modellist1 <- model.sel(m_long_level12_2, m_long_level12_inter2, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter6, m_long_level12_inter7, m_long_level12_inter9, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter31$bobyqa., m_long_level12_inter32, m_long_level12_inter33, m_long_level12_inter34$bobyqa., m_long_level12_inter35$bobyqa., m_long_level12_inter36, m_long_level12_inter37, m_long_level12_inter38, m_long_level12_inter39, m_long_level12_inter322, m_long_level12_inter333, m_long_level12_inter344$optimx.nlminb, m_long_level12_inter355$optimx.nlminb, m_long_level12_inter366$optimx.nlminb, m_long_level12_inter377, m_long_level12_inter388, m_long_level12_inter399, m_long_level12_inter16, m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter8, m_long_level12_inter9, m_long_level12_inter10, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter16, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter24, m_long_level12_inter25, m_long_level12_inter26, m_long_level12_inter27, m_long_level12_inter28, m_long_level12_inter29, m_long_level12_inter30, m_long_level12_inter3222, m_long_level12_inter3333, m_long_level12_inter3666, m_long_level12_inter3777, m_long_level12_inter3888, m_long_level12_inter3999)
modellist1 <- model.sel(m_long_level12_2, m_long_level12_inter2, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter6, m_long_level12_inter7, m_long_level12_inter9, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter31$bobyqa., m_long_level12_inter32, m_long_level12_inter33, m_long_level12_inter34$bobyqa., m_long_level12_inter35$bobyqa., m_long_level12_inter36, m_long_level12_inter37, m_long_level12_inter38, m_long_level12_inter39, m_long_level12_inter322, m_long_level12_inter333, m_long_level12_inter344$optimx.nlminb, m_long_level12_inter355$optimx.nlminb, m_long_level12_inter366$optimx.nlminb, m_long_level12_inter377, m_long_level12_inter388, m_long_level12_inter399, m_long_level12_inter16, m_long_level12_inter1, m_long_level12_inter2, m_long_level12_inter3, m_long_level12_inter4_1, m_long_level12_inter4, m_long_level12_inter5, m_long_level12_inter6, m_long_level12_inter8, m_long_level12_inter9, m_long_level12_inter10, m_long_level12_inter11, m_long_level12_inter12, m_long_level12_inter14, m_long_level12_inter15, m_long_level12_inter16, m_long_level12_inter17, m_long_level12_inter19, m_long_level12_inter20, m_long_level12_inter22, m_long_level12_inter23, m_long_level12_inter24, m_long_level12_inter25, m_long_level12_inter26, m_long_level12_inter27, m_long_level12_inter28, m_long_level12_inter29, m_long_level12_inter30, m_long_level12_inter3222, m_long_level12_inter3333, m_long_level12_inter3666, m_long_level12_inter3777, m_long_level12_inter3888, m_long_level12_inter3999)
print(modellist1)
print(get.models(modellist1, subset = delta < 10))
print(m_long_level12_inter31)
print(m_long_level12_inter31$bobyqa.)
print(modellist1)
install.packages("glmulti")
library(glmulti)
install.packages("rJava")
install.packages("rJava")
library(rJava)
knitr::opts_chunk$set(cache = TRUE)
library(lme4)
library(ggplot2)
library(GGally)
library(plyr)
library(Matrix)
library(nlme)
library(readxl)
library(reshape2)
library(VIF)
library(numDeriv)
library(MuMIn)
library(HLMdiag)
library(DHARMa)
library(bitops)
library(nloptr)
library(optimx)
library(dfoptim)
library(emmeans)
library(afex)
knitr::opts_chunk$set(cache = TRUE)
library(lme4)
library(ggplot2)
library(GGally)
library(plyr)
library(Matrix)
library(nlme)
library(readxl)
library(reshape2)
library(VIF)
library(numDeriv)
library(MuMIn)
library(HLMdiag)
library(DHARMa)
library(bitops)
library(nloptr)
library(optimx)
library(dfoptim)
library(emmeans)
library(afex)
library(usdm)
library(car)
library(glmulti)
library(rJava)
modellist6 <- model.sel(m_level12_1, m_level12_12_all$bobyqa., m_level12_2, m_level12_23_all$bobyqa.)
print(modellist6)
print(m_d_level1_slope1_1)
print(m_level12_22)
print(m_level12_11)
print(m_level12_12)
print(m_level12_11_all)
m_level12_11 <- glmer(allData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + (Fairness_score|ID), data = allData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
print(m_level12_11_all)
m_level12_22 <- glmer(allData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + (Fairness_score|ID), data = allData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
print(m_level12_23_all$bobyqa.)
modellist6 <- model.sel(m_level12_1, m_level12_11, m_level12_12_all$bobyqa., m_level12_2, m_level12_22, m_level12_23_all$bobyqa.)
print(modellist6)
modellist6 <- model.sel(m_level12_1, m_level12_11, m_level12_12_all$bobyqa.)
print(modellist6)
modellist6 <- model.sel(m_level12_1, m_level12_11, m_level12_12_all$bobyqa., m_level12_2, m_level12_22, m_level12_23_all$bobyqa.)
print(modellist6)
summary(m_level12_12_all$bobyqa.)
modellist6 <- model.sel(m_d_level1_slope3_2$bobyqa.,m_level12_1, m_level12_11, m_level12_12_all$bobyqa., m_level12_2, m_level12_22, m_level12_23_all$bobyqa.)
modellist6 <- model.sel(m_d_level1_slope3_2$bobyqa., m_level12_1, m_level12_11, m_level12_12_all$bobyqa., m_level12_2, m_level12_22, m_level12_23_all$bobyqa.)
m_d_level1_slope3_2 <- glmer(allData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + (Fairness_score|ID) + (ReappraisalDirection|ID), data = allData, family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)), na.action = "na.fail")
summary(m_d_level1_slope3_2$bobyqa.)
knitr::opts_chunk$set(cache = TRUE)
library(lme4)
library(ggplot2)
library(GGally)
library(plyr)
library(Matrix)
library(nlme)
library(readxl)
library(reshape2)
library(VIF)
library(numDeriv)
library(MuMIn)
library(HLMdiag)
library(DHARMa)
library(bitops)
library(nloptr)
library(optimx)
library(dfoptim)
library(emmeans)
library(afex)
library(usdm)
library(car)
library(glmulti)
library(rJava)
glmer.glmulti <- function(formula, data, random = ""){
glmer(paste(deparse(formula), random), data = data, REML = FALSE,  family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)))
}
d_model_level12_1 <- glmulti(formula = allData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION) + (ReappraisalDirection|ID) + (Fairness_score|ID), level = 2, fitfunction = glmer.glmulti, random = "+ (ReappraisalDirection|ID) + (Fairness_score|ID)", method = "d", data = allData)
summary(d_model_level12_1)
d_model_level12_1 <- glmulti(formula = allData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION), level = 2, fitfunction = glmer.glmulti, random = "+ (ReappraisalDirection|ID) + (Fairness_score|ID)", method = "d", data = allData)
glmer.glmulti <- function(formula, data, random = ""){
glmer(paste(deparse(formula), random), data = data, REML = FALSE,  family = binomial, control = glmerControl(calc.derivs = FALSE, optCtrl = list(maxfun = 2e4)))
}
d_model_level12_1 <- glmulti(allData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION), level = 2, fitfunction = glmer.glmulti, random = "+ (ReappraisalDirection|ID) + (Fairness_score|ID)", method = "d", data = allData)
d_model_level12_1 <- glmulti(allData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION), level = 1, fitfunction = glmer.glmulti, random = "+ (ReappraisalDirection|ID) + (Fairness_score|ID)", method = "d", data = allData)
d_model_level12_1 <- glmulti(allData$AcceptOffer ~ ReappraisalDirection + scale(totalStake) + Fairness_score + group4 + scale(HRSD_NO_SUI) + scale(HouseholdIncome) + RACETEXT + GENDERTEXT + scale(MMSE) + scale(EDUCATION), level = 1, fitfunction = glmer.glmulti, random = "+ (ReappraisalDirection|ID) + (Fairness_score|ID)", method = "g", data = allData)
knitr::opts_chunk$set(cache = TRUE)
library(lme4)
library(ggplot2)
library(GGally)
library(plyr)
library(Matrix)
library(nlme)
library(readxl)
library(reshape2)
library(VIF)
library(numDeriv)
library(MuMIn)
library(HLMdiag)
library(DHARMa)
library(bitops)
library(nloptr)
library(optimx)
library(dfoptim)
library(emmeans)
library(afex)
library(usdm)
library(car)
library(glmulti)
library(rJava)
task <- read.csv("/Users/kezhang/ownCloud/Suicide_UG/UG_clean_updated/ug_all_task_data.csv")
demo <- read_excel("/Users/kezhang/ownCloud/Suicide_UG/UG_clean_updated/ug_demog.xlsx")
question <- read_excel("/Users/kezhang/ownCloud/Suicide_UG/UG_clean_updated/ug_questionnaire.xlsx")
#task <- read.csv("C:\\Users\\ke\\ownCloud\\Suicide_UG\\UG_clean_updated\\ug_all_task_data.csv")
#demo <- read_excel("C:\\Users\\ke\\ownCloud\\Suicide_UG\\UG_clean_updated\\ug_demog.xlsx")
#question <- read_excel("C:\\Users\\ke\\ownCloud\\Suicide_UG\\UG_clean_updated\\ug_questionnaire.xlsx")
demoQuestion <- merge(demo, question, on = "ID")
allData <- merge(task, demoQuestion, on = "ID")
allData$totalStake <- allData$PlayerProposedAmount + allData$OpponentProposedAmount
allData <- rename(allData, c("HOUSEHOLD INCOME" = "HouseholdIncome", "HRSD NO SUI" = "HRSD_NO_SUI", "PER CAPITA INCOME" = "IncomePerCapita", "MMSE TOTAL" = "MMSE"))
allData$Fairness_score <- as.factor(allData$Fairness_score)
allData$ID <- as.factor(allData$ID)
allData$AcceptOffer <- as.factor(allData$AcceptOffer)
allData$framingContext <- NA
allData$framingContext[allData$ReappraisalDirection == "punish"] <- "framing"
allData$framingContext[allData$ReappraisalDirection == "empathy"] <- "framing"
allData$framingContext[allData$ReappraisalDirection == "baseline"] <- "baseline"
library(knitr)
rmarkdown::render()
rmarkdown::render("UG_data_analysis1.Rmd")
pwd
cd
knit2html("UG_data")
setwd("/Volumes/LAB/Suicide_UG/UG_data_analysis1.Rmd")
setwd("/Volumes/LAB/Suicide_UG/")
ls
knit2html("UG_data_analysis1.Rmd")
setwd("/Volumes/LAB/Suicide_UG")
ls
setwd("/Volumes/LAB/Suicide_UG/UG_data_analysis")
ls
knit2html("UG_data_analysis1.Rmd")
rmarkdown::render("UG_data_analysis1.Rmd")
allData$framingContext <- NA
allData$framingContext <- NA
allData$framingContext[allData$ReappraisalDirection == "punish"] <- "framing"
allData$framingContext[allData$ReappraisalDirection == "empathy"] <- "framing"
allData$framingContext[allData$ReappraisalDirection == "baseline"] <- "baseline"
summary(m_time2)
rmarkdown::render("UG_data_analysis1.Rmd")
