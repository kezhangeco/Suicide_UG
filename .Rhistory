knitr::opts_chunk$set(echo = TRUE)
# significance test on if groups are significantly different in accepting fair/unfair offer.
?prop.test
###five levels
groups5_fair <- matrix(
c(45, 44, 50, 42, 31, 210, 256, 310, 303, 254),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair <- matrix(
c(463, 550, 584, 456, 428, 608, 710, 928, 993, 769),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups5_fair_p <- matrix(
c(0.82, 0.85, 0.86, 0.88, 0.89, 0.18, 0.15, 0.14, 0.12, 0.11),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair_p <- matrix(
c(0.57, 0.56, 0.61, 0.69, 0.64, 0.43, 0.44, 0.39, 0.31, 0.36),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
###four levels
groups4_fair <- matrix(
c(89, 50, 42, 31, 466, 310, 303, 254),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair <- matrix(
c(1013, 584, 456, 428, 1318, 928, 993, 769),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups4_fair_p <- matrix(
c(0.84, 0.86, 0.88, 0.89, 0.16, 0.14, 0.12, 0.11),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair_p <- matrix(
c(0.57, 0.61, 0.69, 0.64, 0.43, 0.39, 0.31, 0.36),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
print("fair")
print(groups5_fair)
print(groups5_fair_p)
print("unfair")
print(groups5_unfair)
print(groups5_unfair_p)
print("fair")
print(groups4_fair)
print(groups4_fair_p)
print("unfair")
print(groups4_fair)
print(groups4_fair_p)
?binom.test
# significance test on if groups are significantly different in accepting fair/unfair offer.
?prop.test
###five levels
groups5_fair <- matrix(
c(45, 44, 50, 42, 31, 210, 256, 310, 303, 254),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair <- matrix(
c(463, 550, 584, 456, 428, 608, 710, 928, 993, 769),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups5_fair_p <- matrix(
c(0.82, 0.85, 0.86, 0.88, 0.89, 0.18, 0.15, 0.14, 0.12, 0.11),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair_p <- matrix(
c(0.57, 0.56, 0.61, 0.69, 0.64, 0.43, 0.44, 0.39, 0.31, 0.36),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
###four levels
groups4_fair <- matrix(
c(89, 50, 42, 31, 466, 310, 303, 254),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair <- matrix(
c(1013, 584, 456, 428, 1318, 928, 993, 769),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups4_fair_p <- matrix(
c(0.84, 0.86, 0.88, 0.89, 0.16, 0.14, 0.12, 0.11),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair_p <- matrix(
c(0.57, 0.61, 0.69, 0.64, 0.43, 0.39, 0.31, 0.36),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
print("fair")
print(groups5_fair)
print(groups5_fair_p)
print("unfair")
print(groups5_unfair)
print(groups5_unfair_p)
print("fair")
print(groups4_fair)
print(groups4_fair_p)
print("unfair")
print(groups4_unfair)
print(groups4_unfair_p)
?binom.test
bino <- Map(binom.test, groups5_fair[, "reject_fair"], rowSums(m))
bino <- Map(binom.test, groups5_fair[, "reject_fair"], rowSums(groups5_fair))
bino1 <- apply(groups5_fair, function(x) binom.test(x, p=0.5))
bino1 <- apply(groups5_fair, function(reject_fair) binom.test(reject_fair, p=0.5))
print(bino)
?Map
# significance test on if groups are significantly different in accepting fair/unfair offer.
?prop.test
###five levels
groups5_fair <- matrix(
c(45, 44, 50, 42, 31, 210, 256, 310, 303, 254),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair <- matrix(
c(463, 550, 584, 456, 428, 608, 710, 928, 993, 769),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups5_fair_p <- matrix(
c(0.82, 0.85, 0.86, 0.88, 0.89, 0.18, 0.15, 0.14, 0.12, 0.11),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair_p <- matrix(
c(0.57, 0.56, 0.61, 0.69, 0.64, 0.43, 0.44, 0.39, 0.31, 0.36),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
###four levels
groups4_fair <- matrix(
c(89, 50, 42, 31, 466, 310, 303, 254),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair <- matrix(
c(1013, 584, 456, 428, 1318, 928, 993, 769),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups4_fair_p <- matrix(
c(0.84, 0.86, 0.88, 0.89, 0.16, 0.14, 0.12, 0.11),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair_p <- matrix(
c(0.57, 0.61, 0.69, 0.64, 0.43, 0.39, 0.31, 0.36),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
?Map
b_group5_fair <- Map(binom.test, groups5_fair[, "accept_fair"], rowSums(groups5_fair))
b_group5_unfair <- Map(binom.test, groups5_unfair[, "accept_unfair"], rowSums(groups5_unfair))
b_group4_fair <- Map(binom.test, groups4_fair[, "accept_fair"], rowSums(groups4_fair))
b_group4_unfair <- Map(binom.test, groups4_unfair[, "accept_unfair"], rowSums(groups4_unfair))
print("fair")
print(groups5_fair)
print(groups5_fair_p)
print(b_group5_fair)
print("unfair")
print(groups5_unfair)
print(groups5_unfair_p)
print(b_group5_unfair)
print("fair")
print(groups4_fair)
print(groups4_fair_p)
print(b_group4_fair)
print("unfair")
print(groups4_unfair)
print(groups4_unfair_p)
print(b_group4_unfair)
?chisq.test
cs_group5_fair <- chisq.test(groups5_fair)
cs_group5_fair <- chisq.test(groups5_fair)
cs_group5_fair1 <- chisq.test(groups5_fair[, "accept_fair"])
print(cs_group5_fair)
print(cs_group5_fair1)
print(groups5_fair[, "accept_fair"]
)
cs_group5_fair <- chisq.test(groups5_fair)
cs_group5_fair1 <- chisq.test(groups5_fair[, "accept_fair"])
print(cs_group5_fair)
print(cs_group5_fair1)
print(sigma.test(groups5_fair[, "accept_fair"], sigma=6))
install.packages("TeachingDemos")
library(TeachingDemos)
print(sigma.test(groups5_fair[, "accept_fair"], sigma=6))
cs_group5_fair <- chisq.test(groups5_fair)
cs_group5_fair1 <- chisq.test(groups5_fair[, "accept_fair"])
print(cs_group5_fair)
print(cs_group5_fair1)
print(sigma.test(groups5_fair[, "accept_fair"], sigma=6))
library(TeachingDemos)
# significance test on if each group are significantly different in accepting fair/unfair offer.
?prop.test
###five levels
groups5_fair <- matrix(
c(45, 44, 50, 42, 31, 210, 256, 310, 303, 254),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair <- matrix(
c(463, 550, 584, 456, 428, 608, 710, 928, 993, 769),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups5_fair_p <- matrix(
c(0.82, 0.85, 0.86, 0.88, 0.89, 0.18, 0.15, 0.14, 0.12, 0.11),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair_p <- matrix(
c(0.57, 0.56, 0.61, 0.69, 0.64, 0.43, 0.44, 0.39, 0.31, 0.36),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
###four levels
groups4_fair <- matrix(
c(89, 50, 42, 31, 466, 310, 303, 254),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair <- matrix(
c(1013, 584, 456, 428, 1318, 928, 993, 769),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups4_fair_p <- matrix(
c(0.84, 0.86, 0.88, 0.89, 0.16, 0.14, 0.12, 0.11),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair_p <- matrix(
c(0.57, 0.61, 0.69, 0.64, 0.43, 0.39, 0.31, 0.36),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
?Map
b_group5_fair <- Map(binom.test, groups5_fair[, "accept_fair"], rowSums(groups5_fair))
b_group5_unfair <- Map(binom.test, groups5_unfair[, "accept_unfair"], rowSums(groups5_unfair))
b_group4_fair <- Map(binom.test, groups4_fair[, "accept_fair"], rowSums(groups4_fair))
b_group4_unfair <- Map(binom.test, groups4_unfair[, "accept_unfair"], rowSums(groups4_unfair))
print("fair")
print(groups5_fair)
print(groups5_fair_p)
print(b_group5_fair)
print("unfair")
print(groups5_unfair)
print(groups5_unfair_p)
print(b_group5_unfair)
print("fair")
print(groups4_fair)
print(groups4_fair_p)
print(b_group4_fair)
print("unfair")
print(groups4_unfair)
print(groups4_unfair_p)
print(b_group4_unfair)
### if one group is signiifcantly different in accepting fair/unfair offer
?chisq.test
print("chisq on accepting fair across groups")
print(chisq.test(groups5_fair[, "accept_fair"]))
print("chisq on accepting unfair across groups")
cs_group5_unfair <- chisq.test(groups5_fair[, "accept_fair"])
print(cs_group5_fair)
print(cs_group5_fair1)
print("chisq on accepting fair across groups")
print(chisq.test(groups5_fair[, "accept_fair"]))
print("chisq on accepting unfair across groups")
print(chisq.test(groups5_unfair[, "accept_unfair"]))
print("chisq on accepting fair across groups")
print(chisq.test(groups4_fair[, "accept_offer"]))
library(TeachingDemos)
# significance test on if each group are significantly different in accepting fair/unfair offer.
?prop.test
###five levels
groups5_fair <- matrix(
c(45, 44, 50, 42, 31, 210, 256, 310, 303, 254),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair <- matrix(
c(463, 550, 584, 456, 428, 608, 710, 928, 993, 769),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups5_fair_p <- matrix(
c(0.82, 0.85, 0.86, 0.88, 0.89, 0.18, 0.15, 0.14, 0.12, 0.11),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups5_unfair_p <- matrix(
c(0.57, 0.56, 0.61, 0.69, 0.64, 0.43, 0.44, 0.39, 0.31, 0.36),
nrow = 5, ncol=2, dimnames = list(c("AttHL", "AttLL", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
###four levels
groups4_fair <- matrix(
c(89, 50, 42, 31, 466, 310, 303, 254),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair <- matrix(
c(1013, 584, 456, 428, 1318, 928, 993, 769),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
groups4_fair_p <- matrix(
c(0.84, 0.86, 0.88, 0.89, 0.16, 0.14, 0.12, 0.11),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_fair", "accept_fair")))
groups4_unfair_p <- matrix(
c(0.57, 0.61, 0.69, 0.64, 0.43, 0.39, 0.31, 0.36),
nrow = 4, ncol=2, dimnames = list(c("Att", "Control", "Depression", "ideator"), c("reject_unfair", "accept_unfair")))
?Map
b_group5_fair <- Map(binom.test, groups5_fair[, "accept_fair"], rowSums(groups5_fair))
b_group5_unfair <- Map(binom.test, groups5_unfair[, "accept_unfair"], rowSums(groups5_unfair))
b_group4_fair <- Map(binom.test, groups4_fair[, "accept_fair"], rowSums(groups4_fair))
b_group4_unfair <- Map(binom.test, groups4_unfair[, "accept_unfair"], rowSums(groups4_unfair))
print("fair")
print(groups5_fair)
print(groups5_fair_p)
print(b_group5_fair)
print("unfair")
print(groups5_unfair)
print(groups5_unfair_p)
print(b_group5_unfair)
print("fair")
print(groups4_fair)
print(groups4_fair_p)
print(b_group4_fair)
print("unfair")
print(groups4_unfair)
print(groups4_unfair_p)
print(b_group4_unfair)
### if one group is signiifcantly different in accepting fair/unfair offer
?chisq.test
print("chisq on accepting fair across groups")
print(chisq.test(groups5_fair[, "accept_fair"]))
print("chisq on accepting unfair across groups")
print(chisq.test(groups5_unfair[, "accept_unfair"]))
print("chisq on accepting fair across groups")
print(chisq.test(groups4_fair[, "accept_offer"]))
print("chisq on accepting fair across groups")
print(chisq.test(groups5_fair[, "accept_fair"]))
print("chisq on accepting unfair across groups")
print(chisq.test(groups5_unfair[, "accept_unfair"]))
print("chisq on accepting fair across groups")
print(chisq.test(groups4_fair[, "accept_fair"]))
print("chisq on accepting unfair across groups")
print(chisq.test(groups4_unfair[, "accept_unfair"]))
print("chisq on accepting fair across groups")
print(chisq.test(groups5_fair_p[, "accept_fair"]))
print("chisq on accepting unfair across groups")
print(chisq.test(groups5_unfair_p[, "accept_unfair"]))
print("chisq on accepting fair across groups")
print(chisq.test(groups4_fair_p[, "accept_fair"]))
print("chisq on accepting unfair across groups")
print(chisq.test(groups4_unfair_p[, "accept_unfair"]))
library(excel)
library(readxl)
group5 <- read_excel("/Users/kezhang/ownCloud/Suicide_UG/UG_clean_data/group5_condition_offer.xlsx")
View(group5)
Y<-scan()
group5 <- read_excel("/Users/kezhang/ownCloud/Suicide_UG/UG_clean_data/group5_condition_offer.xlsx", sheet = "Sheet1")
View(group5)
a1= anova(lm(group5[, -2]~group5["fair_code"]+group5["ReappraisalDirection"]+group5["group5"]))
a1= anova(lm(group5["1"]~group5["fair_code"]+group5["ReappraisalDirection"]+group5["group5"]))
group5["fair_code"]
a1= anova(lm(group5["1"]~group5["fair_code"]+group5["ReappraisalDirection"]+group5["group5"]))
group5 <- read_excel("/Users/kezhang/ownCloud/Suicide_UG/UG_clean_data/group5_condition_offer.xlsx", sheet = "Sheet1")
a1= anova(lm(group5["accept"]~group5["fair_code"]+group5["ReappraisalDirection"]+group5["group5"]))
a1= anova(group5["accept"]~group5["fair_code"]+group5["ReappraisalDirection"]+group5["group5"])
a1= anova(lm(group5["accept"]~group5["fair_code"]*group5["ReappraisalDirection"]*group5["group5"]))
a1= anova(lm(group5$accept~group5$fair_code*group5$ReappraisalDirection*group5$group5))
a1= anova(lm(group5$accept~group5$fair_code*group5$ReappraisalDirection*group5$group5))
summary(a1)
group5 <- read_excel("/Users/kezhang/ownCloud/Suicide_UG/UG_clean_data/group5_condition_offer.xlsx", sheet = "Sheet2")
a1= anova(lm(group5$Accept~group5$fairness*group5$ReappraisalDirection*group5$group5))
group5 <- read_excel("/Users/kezhang/ownCloud/Suicide_UG/UG_clean_data/group5_condition_offer.xlsx", sheet = "Sheet2")
a1= anova(lm(group5$Accept~group5$fairness*group5$ReappraisalDirection*group5$group5))
Y <- scan()
